<%- include("../header") %>
<h1 style="color: red; text-align: center" class="error">Az oldal nem támogatja ezt a képernyő szélességet</h1>
<div class="container mt-0 mt-sm-3">
    <%- include("../menu") %>
    <div class="content">
        <div id="tabs" class="content">
            <ul>
                <li><a href="#all-blogs">Összes blog</a></li>
                <li><a href="#user-blogs">Saját blogok</a></li>
            </ul>
            <div class="container" id="all-blogs"></div>
            <div class="container p-auto" id="user-blogs"></div>
        </div>
    </div>
    <%- include("../foot") %>
</div>

<script>
    $(function () {
        $('#tabs').tabs();
    });

    $.ajax({ method: 'get', url: './getAllActiveBlog' })
        .done((data) => {
            let str = '';

            data.data.blogs.forEach((element) => {
                str += `<div class="mt-3 col-12 col-lg-8 m-auto">
            <div class="m-1 p-4 gray">
                <h2 class="d-block p-0"s>${element.cim}</h2>
                <h6>Készítette: ${element.felhasznalo}</h6>
                <hr />
                <div class="blog-content">
                    <p>${element.tartalom}</p>
                </div>
                <h6 class="col-12 text-end">${moment(element.idopont).format('YYYY-MM-DD, hh:mm')}</h6>
            </div>
            </div>`;
            });

            $('#all-blogs').html(str);
        })
        .fail((err) => {
            notify('Adatbázis hiba');
            console.log(err);
        })
        .always(() => {});

    $.ajax({ method: 'get', url: './getBlogByUser' })
        .done((data) => {
            let str = '<button class="btn btn-success m-auto">Új blog</button>';

            data.data.blogs.forEach((element) => {
                if (element.status == 1) {
                    style = 'btn btn-success';
                    state = 'Aktív';
                } else {
                    style = 'btn btn-danger';
                    state = 'Inaktív';
                }

                str += `<div class="mt-3 col-12 col-lg-8 m-auto">
            <div class="m-1 p-4 gray">
                <div style="width: 100px" class="float-end ${style}">${state}</div>
                <h2 class="d-block p-0"s>${element.cim}</h2>
                <h6>Készítette: ${element.felhasznalo}</h6>
                <hr />
                <div class="blog-content">
                    <p>${element.tartalom}</p>
                </div>
                <h6 class="col-12 text-end">${moment(element.idopont).format('YYYY-MM-D, hh:mm')}</h6>
            </div>
            </div>`;
            });

            $('#user-blogs').html(str);
        })
        .fail((err) => {
            notify('Adatbázis hiba');
            console.log(err);
        })
        .always(() => {});
</script>

<%- include("../footer") %>
